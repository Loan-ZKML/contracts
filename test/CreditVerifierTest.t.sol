// SPDX-License-Identifier: MIT
pragma solidity 0.8.28;

import {Test, console} from "forge-std/Test.sol";
import {CreditVerifier} from "../src/CreditVerifier.sol";
import {IZKCreditVerifier} from "../src/IZKCreditVerifier.sol";

contract CreditVerifierTest is Test {
    IZKCreditVerifier s_creditVerifier;

    function setUp() public {
        s_creditVerifier = new CreditVerifier();
    }

    // ----------------
    // verifyProof()
    // ----------------
    function test_caseOne() public view {
        bytes memory _proof =
            "0x20f3bf5e005a9206606a133d89f67332d1b86780bf7f6b4cd68d858f8b843bea23247e82a78164ca47a65ecde48d961447336f5273c72d207e740a78483f910d136126ab80a094ab28bad7e552c54235703f8f77ce7e5e4ae45aa106318aa3f61e9ca20bec53bbcbb9d18a828442d2ab1695d7fd0f21b419506a7824bd39213d0c7f87b957b5063826679f97283df918a649def879fc342c0b6651eda0e5de930981ff0f39c2f64b57037c2ce06b2d503d70c3c0cc23f874f7cb5d058bac101c29d1726cb3fc309e603ed3d1e34850b37c95f968f8cbf47d394b453ee8add9700fac2d4a7a5c608cf4cabe97e7d93c74d7d45c285875f2ffa52ef4f33961cc8e205ffc6915f3b90d663000bdf8a5ca3ea7dc890171baa26bf2ae855ff1be32f01f6a8898b29286dcc7e1a8b6c0e31ec1c5a077498f83a5d8c8453615b958df32266309c3f0992a9319ea7e71bb15d7df1e75069db72bcd0285f08e0ab11e93cd1e10e58e3463fe31a5ebcabf5471e0f8998e0d323ec263343eaedf4d5b1946b900577c5dc7510b687fd03b40c8718ca1b8a1330daa170d56349c5a79de6d10f90593096b71407e34ff579ee7b86792ea873f58f24933247328a34c3e0d1f9118234ee8a677e3e0e929f829a472cded78738354d0a53074b983f85060ecbae7c921c66d31e11793ce4cc2c4af2613c573aba9fffba163e39421b2e46c18caa92a05f36dc0fc00954375711c8ac6107d2e55b2a8a4536033f59966fd3b10855ed50042cc3e896b8a30bb4e157c12d8dff02bc706dc3bb1ee910eb23801ff2415142585cad7c0594b801008339509aeecc130da8ca562a70821343e1a438559ba3114670541b73f88f56d8e3e3f7f1cf9b7a7b476cd963984b0ca7849d4b9acfb5000577c5dc7510b687fd03b40c8718ca1b8a1330daa170d56349c5a79de6d10f90593096b71407e34ff579ee7b86792ea873f58f24933247328a34c3e0d1f91181672ac7fe3a941c0d5a9e51492123b466bb28063df42016f36d2f1df6a0a18eb2f9a4fa75e87f6ddc4885c6bfaba37bf6ef4865424d12cca5f1f0c8310ebc819019dabd79e189aeb33686a91e8d0d070c8faf9cf34b75600b5f3bb2697d93a4a1f1c32e34c8c9ff1453d675fe27a2a5428b7061ef1023342771389e85354f93d2e38bb6a712de63e3c674461eefe8a577ff7ab2e8f59dfea0a6511842ea322fa2f29eb090a92e64fb3904b4571c63ac1f4cc0572a0c00fee3133b6bdc844ae1c00c3435a4234f84fd71a1ddbf8db77b8b7f49d47b15a6d21640ed3c58f3968b903987a665660a102f3a092cadee814ab1074279d1204a04199310b1184cdad79256f1dd73c75e9c756d6ef8d90595884419aa61799a2fd57223b08ee6d4f62da232eb95f981b11a86cca1505668cb9cd333d9719d53f396ae5058822ef6c4c451ff238f3f7ef48aa90e9277bd17704c4503d992b5e068505b352dc59e916e3ff0c06ab22a7d70eb366b7e0270a7112358f2e541302589187ab1690ea1589d60b03222367cce91d6d53e4071a484f9eeacf6bf204276fc62386dcb9e105c335ce06dd5f3c90a6ffb0c822f539d2bed42c9312fa278f8cd755ca0bf8ec1c9053981b5d8128823fb3ee6403b9e8dc4902e2bcc8a2cdf4bebb1cb477a60b837760ad15b71b0b05d5958d8b33bd4f63a1d2c1a44bbb7650a19c96216f06c80c7d38dd25127434fa57de8f7bbce72801ecb003134c1d61c3f31151e5582a8ee3653f622dd63fd716f4b6609c6e319817cb9ad620f4986a60dda8f0e9c8165ab283771d2ea857ca8abf4abda3988f158da98697a1afea8cb7012a901e8f2e27f90bf7a61c9417eb7b53ce667b3652caef521ba1b33370b2fb22b3be3789942127fd64d00675fcdbb3d13eaa737a68641d1ad2ea0eb5b94ee208bf002337fde052d28dfd040a6783c8c073f062dc4589c7f1585e4ee531dbe65097089d46e01e23e39b441ce181d5489538449a064ca4d96e39ed57da18ea94db0cc47823c8e6409f31262622612f81b13c4191cdb3c5fd3b60bbe5c480756435ee31d8ec8476d0f9760e250aa16f031b1a74dc4f1daa471318150683d1690a26d8458ecfeef626f0f42d1835803409bef61d308bdc2316333d9f5b73c35da429fb3bddd4b83d9dc57d1717c37343450ce12b451ce26e729c8c5ba98f38d4055e8b7a5dc10e844d762bea20e11c275fffe3a4d99ae703422b69de900c4cbcf8f48e25bb3418b202fcf0c42e122ed1c5908194f8b34053ee98b7880adf737afd7bf1c01510df7d9508d825014634a126ba3983f23e7260fbf51480f7e39ef8504d750581d4a809380760e510161d01a7a5cf1ba2ad0444f79e04d513b441126a81f8d2c5fa02fa7e5d9167057463070cf85bbcfb92b05133326f646270c8d11758dfb30760979d7e23bd241d18de153fcefa0688bfb236191186023aacdeb1ebfabdfcb8546796cbcc216f273356e957199b130fb32ad2e35e157576ca885c8fcd0089015a7e9f01519aa723dc3b9f338777b30b28f7a7622a6eb13a0751f7f7eb7609492d67ae8239414f0595debaf2c91da0eeda03289b0fce3ebea6a4823664c6b3ccf7026a354791aa1f07862e5391f855180c53d6f25b05567c44d5ebf53d87cba3f7eb11fa295873108580882061b7b7ee4b59db995555ff21743f49d2fb85f1b02816a0377dca201c611f24c83751e54d6b48d80fd063e888a65bb227ba0b5098ed9ab83043736c22cd1b09ea8f7edfb881814b5df22cd45230cbb8400caa78b5e2929f7badf1cc174723ca2a73f65625199a14b2e7bca81389596a991020d7c776150cd837c43a07eb36b4f42aa226583b906e4086ed5001be9b596cd33ab1b82bc763faa0f5ab00000000000000000000000000000000000000000000000000000000000000002cd28c9419e93f54c4b85965b8cd095ff54afaf05112c0260f8dbe84e4470f181afe752751bd9353a8e059e59febd11793f26daf126f034bd2aabb24026dca45056a1c94cbb202facdac319f656e6182a73477322f2718ac3bad1f9b926b4459045f00ed2539a4751ed54498d0687b26d0d3affcb55283b60b266d13fb955fd6045f00ed2539a4751ed54498d0687b26d0d3affcb55283b60b266d13fb955fd610614ef95e857ddd9b27934950f8f64284723d1aa2cda50625547b1a10b4b5552ba298bf62e5c0abdefa637f8e2bf1deb78f4e401d5dc18924ec00fecaed46ea105ed5e9b674d2e4280838557526cf325de5376d4f978cd115c902693de691b900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000275ef4444a59ea46e2a2abf4450c587971842b09fd678efb451b38f0b01db2801bf0bdd1cb5790e4318654983c806d1fddde39d32e3f41c058f547d1e4f16255130176fd2870c73283eab3a0c63b241cfb596bda39397f5de155394aff8c8edb2ad67140c09fe469360d9f112593a5ba93cc5ab1fbc176ca70c8258fd37e1580259251028d07f70b620b3269ac73ff108069fe21b91b3fd4c8d46fb776adae40005163799e826261a1b772661f0bb910185f69df9358169e73fd311271caec071b55cc77b2d82215186966bfa63953fc1f9411ec11f8ad4f3a7259de4466ac1c2993c5655d537f5bed1944291d23f297984fc59008cec0b3fa17c085830718d322aab6e5c85eb06787d69e2bb691505470d13755e57c4a40263794f0f43196022a6c2e4e5d03ba2ab322b7680bfe58d6e88447036b5163177ed9d5b408e661382bf8a138c639f9d0d58fcc265cb25f45e6bc69fbe1c84112e0ed5a201ab616d706ff0794f19bc1b79cf76bccb601a2169cea9fbe4790530ad040e2ecbc3e54ee2e0d04f0f320176e11d8fc2fc08b6a81b074fc41d1f8d611620cde2c33dbd4d50b35685ea760577c6a892fb4f23bd4226a4518e5ebc89e00c7613973f55ddad516a7a5e79b0ececb765026d7334322043dfb634a664aed141e46034213f2589220f49193e84f31d196e3e5bd8b969106c0b010af9e4eebb0f966b56e09cefe7c21286cd7c385531a03aa652f75e9e675fd7ac906aa33e9473738803f4a78e9b82fe94a0cecef387315efb482e0412c8d8c26d875960ae8799f49cdaa1d66f0a629f971b395fd63b9c3470f41fb51b221bbbda9fecbe4fdbafcb957b7e0de000d2ff5b964ae3322eb6dda5b7f0a1d442d1ee4b7d1cb677035a8c66b6ee54e65b61822ea54713eb04e18e46ad7aaca4db6390bf7e7e08b4bcc2fa017829b79b79f2cab1677790e6b05d29150bafb4ea58aa4b4dce3219442eaab8fe840bc02b41611b91ac931a1725b65b9948bf9dc59c9e183090c47912d886d55ad3610ec7d6a0b01e01868c259191f299c7752c5f09200d0896bcabb09caee09b139449b430e03e18f48dc5403308e835692d3f441b8a451e4491f18fb3cf471c6e48dd63c30121acc672e3653c33f85ed2fd5783929aba0590693e81a0b923633dfa89b23231cf03ea97e074bd3d45679970250c18fa524119955edd45c34ff04d11fc4e69c3007e28f77fd8aedf80c128b2658f778a5a40e848ac26afafcb7234a7b2d0d781477b437eeb070987460589cf42766fb10d8f4f4dc992958d09bec9e14deda6511e91bb89d27e5405533adeff6e03aac62c55880943c1ba08c26e1d9b493b8eb2985c5dcf0178339becf8338c79beaa83c4fa8de70b1e9c3f68288ca5f20ed542ff5b964ae3322eb6dda5b7f0a1d442d1ee4b7d1cb677035a8c66b6ee54e65b627c0a6487b74923f41bed158cab26c99e95126b6e3af41e7c0778f0e73b0733f2ac3432c3d20230b76f9fdee568c69dcf66d909cb215b19b0dbb92699118cabd19729532d03d5799c7d9c3c5efd92e6651bfcc42917cb6bd17461ec43d03926f11f64e24df87cdfaf0bbbfd29de8c0115f76dec64057dc5415c8d3acad4df2e70bebafd71d3b6ba7802abf469833dd06d292575b76267233f6ba6d7b7b626afe02e70a257898092378aeb6b5aaff9f706f6a76929bb05d21ace71fd35ce6f94f13b34418fb478f9ef1045af6ab5ca8879e0164c5dbc0c174e4c01b61ab68be63";

        uint256[] memory _publicInputs = new uint256[](1);
        _publicInputs[0] = uint256(0x6d14000000000000000000000000000000000000000000000000000000000000);

        bool verified = s_creditVerifier.verifyProof(_proof, _publicInputs);

        assertEq(verified, true, "Invalid Proof");
    }
}
